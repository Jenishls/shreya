<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Pizza - Free Bootstrap 4 Template by Colorlib</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    
    <link href="https://fonts.googleapis.com/css?family=Poppins:300,400,500,600,700" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Josefin+Sans" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Nothing+You+Could+Do" rel="stylesheet">

    <link rel="stylesheet" href="css/open-iconic-bootstrap.min.css">
    <link rel="stylesheet" href="css/animate.css">
    
    <link rel="stylesheet" href="css/owl.carousel.min.css">
    <link rel="stylesheet" href="css/owl.theme.default.min.css">
    <link rel="stylesheet" href="css/magnific-popup.css">

    <link rel="stylesheet" href="css/aos.css">

    <link rel="stylesheet" href="css/ionicons.min.css">

    <link rel="stylesheet" href="css/bootstrap-datepicker.css">
    <link rel="stylesheet" href="css/jquery.timepicker.css">

    
    <link rel="stylesheet" href="css/flaticon.css">
    <link rel="stylesheet" href="css/icomoon.css">
    <link rel="stylesheet" href="css/style.css">
    <style type="text/css">
      .ftco-animate {
        opacity: 1 !important;
        visibility: visible !important;
      }
    </style>
  </head>
  <body>
  	<nav class="navbar navbar-expand-lg navbar-dark ftco_navbar bg-dark ftco-navbar-light" id="ftco-navbar">
        <div class="container">
              <a class="navbar-brand" href="index.html"><img style="height: 100px;" src="images/logo.jpg"></a>
              <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#ftco-nav" aria-controls="ftco-nav" aria-expanded="false" aria-label="Toggle navigation">

                <span class="oi oi-menu"></span> Menu
              </button>
          <div class="collapse navbar-collapse" id="ftco-nav">
            <ul class="navbar-nav ml-auto">
              <li class="nav-item "><a href="index.html" class="nav-link">Home</a></li>
              <li class="nav-item active"><a href="menu.html" class="nav-link">Menu</a></li>
              <li class="nav-item"><a href="about.html" class="nav-link">About</a></li>
            <li class="nav-item"><a href="contact.html" class="nav-link">Contact</a></li>
            <li class="nav-item"><a class="nav-link" style="cursor: pointer;" id="dashboard">Dashboard</a></li>
            <li class="nav-item"><a class="nav-link"  style="cursor: pointer;" id="logout">Logout</a></li>
            </ul>
          </div>
          </div>
      </nav>
    <!-- END nav -->

    <section class="home-slider owl-carousel img" style="background-image: url(images/bg_1.jpg);">

      <div class="slider-item" style="background-image: url(images/bg_3.jpg);">
      	<div class="overlay"></div>
        <div class="container">
          <div class="row slider-text justify-content-center align-items-center">

            <div class="col-md-7 col-sm-12 text-center ftco-animate">
            	<h1 class="mb-3 mt-5 bread">Our Menu</h1>
	            <p class="breadcrumbs"><span class="mr-2"><a href="index.html">Home</a></span> <span>Menu</span></p>
            </div>

          </div>
        </div>
      </div>
    </section>
    
		<section class="ftco-section">
    	<div class="container">
    		<div class="row justify-content-center mb-5 pb-3">
          <div class="col-md-7 heading-section ftco-animate text-center">
            <h2 class="mb-4">Our Menu</h2>
            <p>Far far away, behind the word mountains, far from the countries Vokalia and Consonantia, there live the blind texts.</p>
          </div>
        </div>
    	</div>
    	<div class="container-wrap">
    		<div class="row no-gutters d-flex" id="menu_item_container">
    			
    		</div>
    	</div>

    	
  

  <!-- loader -->
  <div id="ftco-loader" class="show fullscreen"><svg class="circular" width="48px" height="48px"><circle class="path-bg" cx="24" cy="24" r="22" fill="none" stroke-width="4" stroke="#eeeeee"/><circle class="path" cx="24" cy="24" r="22" fill="none" stroke-width="4" stroke-miterlimit="10" stroke="#F96D00"/></svg></div>


  <script src="js/jquery.min.js"></script>
  <script src="js/jquery-migrate-3.0.1.min.js"></script>
  <script src="js/popper.min.js"></script>
  <script src="js/bootstrap.min.js"></script>
  <script src="js/jquery.easing.1.3.js"></script>
  <script src="js/jquery.waypoints.min.js"></script>
  <script src="js/jquery.stellar.min.js"></script>
  <script src="js/owl.carousel.min.js"></script>
  <script src="js/jquery.magnific-popup.min.js"></script>
  <script src="js/aos.js"></script>
  <script src="js/jquery.animateNumber.min.js"></script>
  <script src="js/bootstrap-datepicker.js"></script>
  <script src="js/jquery.timepicker.min.js"></script>
  <script src="js/scrollax.min.js"></script>
  <script src="js/main.js"></script>
  <script src="js/jquery.min.js"></script>
    <script src="js/axios.js"></script>

<script type="text/javascript">
  jQuery(document).ready(function($) {
    axios.defaults.headers.post['Content-Type'] = 'application/json;charset=utf-8';
    axios.defaults.headers.post['Access-Control-Allow-Origin'] = '*';
    axios.get('http://localhost:7000/api/menu')
        .then(function(response) {
          let tr ="";
            $.each(response.data, function(index, val) {
                tr += `<div class="col-lg-4 d-flex ftco-animate">
                        <div class="services-wrap d-flex">
                          <a href="#" class="img" style="background-image: url(images/pizza-1.jpg);"></a>
                          <div class="text p-4">
                            <h3>${val.title}</h3>
                            <p>${val.desc}</p>
                            <p class="price"><span>$${val.price}</span>
                              <input type="number" name="qty" class="item_qty" style="width:30%;"> 
                              <a style="cursor:pointer;" data-price="${val.price}" data-id="${val.id}" class="ml-2 btn btn-white btn-outline-white make_order">Order</a>
                            </p>
                          </div>
                        </div>
                      </div>
                `;
            });

            $('#menu_item_container').html(tr);
        })
        .catch(function(error) {
            console.log(error);
        })

    });

  $(document).off('click', '.make_order').on('click', '.make_order', function(e){
        // event.preventDefault();
        console.log('click');
        const price = $(this).attr('data-price');
        const qty = $(this).parent().children('.item_qty').val();
        const user_id = localStorage.getItem('user_id');
        const menu_id = $(this).attr('data-id');

        axios.defaults.headers.post['Content-Type'] = 'application/json;charset=utf-8';
        axios.defaults.headers.post['Access-Control-Allow-Origin'] = '*';
        axios.post('http://localhost:7000/api/order', {
            headers: {
                "Authorization": localStorage.getItem('accessToken')
            },
            menu_id: menu_id,
            price: price,
            quantity: qty,
            user_id: user_id,
        })
        .then(function(response) {
            $.each(response.data, function(index, val) {
                localStorage.setItem(index, val)
            });
            window.location.href = "menu.html"
        })
        .catch(function(error) {
            console.log(error);
        })
    });

  </script>
    <script type="text/javascript">
    $(document).ready(function(e){
      let user_id = localStorage.getItem('user_id');
      if(!user_id){
        window.location.href = "login.html"
      }
    })
    $('#dashboard').on('click', function(e){
      let isAdmin = localStorage.getItem('isAdmin');
      console.log(isAdmin)
      if(isAdmin == 1){
        window.location.href = "resturant-owner/index.html"
      }
      else{
        window.location.href = "resturant-user/index.html"
      }
    })

    $('#logout').on('click', function(e){
      localStorage.removeItem('isAdmin');
      localStorage.removeItem('user_id');
      window.location.href = "login.html"
    })
  </script>
  </body>
</html>